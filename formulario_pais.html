<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrﾃｭcula Escolar | Tio Jonas</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        h2 { color: #d39e00; text-align: center; }
        input, select { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: #27ae60; color: white; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 20px; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .success-msg { display: none; text-align: center; color: #27ae60; margin-top: 20px; font-weight: bold; }
        .filho-2-area { display: none; background: #fff8e1; padding: 15px; border-radius: 8px; border: 1px dashed #d39e00; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="container">
        <h2>泅 Matrﾃｭcula Tio Jonas</h2>
        <p style="text-align: center; color: #666;">Preencha para solicitar o contrato.</p>

        <form id="formPais">
            <h3>汨､ Responsﾃ｡vel</h3>
            <input type="text" id="cliente_nome" placeholder="Nome Completo (Pai/Mﾃ｣e)">
            <input type="text" id="cliente_cpf" placeholder="CPF">
            <input type="text" id="cliente_rg" placeholder="RG">
            <input type="text" id="cliente_endereco" placeholder="Endereﾃｧo Completo">
            <input type="text" id="cliente_telefone" placeholder="WhatsApp Principal">
            <input type="text" id="cliente_telefone_2" placeholder="Telefone Recado (Opcional)">

            <h3>沁 Alunos</h3>
            <select id="qtd_filhos" onchange="mostrarFilho2()">
                <option value="1">1 Filho</option>
                <option value="2">2 Filhos</option>
            </select>

            <div style="background:#f9f9f9; padding:15px; border-radius:8px;">
                <input type="text" id="aluno_nome_1" placeholder="Nome do Aluno 01">
                <select id="escola_nome">
                    <option value="">Selecione a Escola...</option>
                    <option value="Adventista">Adventista</option>
                    <option value="Delta">Delta</option>
                    <option value="Escola 3">Escola 3</option>
                    <option value="Escola 4">Escola 4</option>
                    <option value="Paranﾃ｡">Paranﾃ｡</option>
                    <option value="CEF 04">CEF 04</option>
                    <option value="COC">COC</option>
                </select>
                <select id="escola_horario">
                    <option value="">Selecione o Horﾃ｡rio...</option>
                    <option value="Matutino">Matutino (Manhﾃ｣)</option>
                    <option value="Vespertino">Vespertino (Tarde)</option>
                    <option value="Integral">Integral</option>
                </select>
            </div>

            <div id="area_filho_2" class="filho-2-area">
                <input type="text" id="aluno_nome_2" placeholder="Nome do Aluno 02">
                <small>*Considerando mesma escola.</small>
            </div>

            <button type="button" id="btnEnviar" onclick="enviarPedido()">笨 ENVIAR SOLICITAﾃﾃグ</button>
            <div id="msgSucesso" class="success-msg">
                沁 Enviado com sucesso!<br>Tio Jonas entrarﾃ｡ em contato em breve.
            </div>
        </form>
    </div>

    <script type="module">
        // USANDO A MESMA CONFIGURAﾃﾃグ DO SEU SISTEMA
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCTvlujToSUX3JvLakYv9Dwt-9B7sgW7t8",
            authDomain: "financeiro-32139.firebaseapp.com",
            projectId: "financeiro-32139",
            storageBucket: "financeiro-32139.firebasestorage.app",
            messagingSenderId: "929380352090",
            appId: "1:929380352090:web:e5ea8655635e8f52e05863"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.mostrarFilho2 = function() {
            const qtd = document.getElementById('qtd_filhos').value;
            document.getElementById('area_filho_2').style.display = (qtd === '2') ? 'block' : 'none';
        };

        window.enviarPedido = async function() {
            const btn = document.getElementById('btnEnviar');
            btn.disabled = true;
            btn.innerText = "Enviando...";

            const dados = {
                cliente_nome: document.getElementById('cliente_nome').value,
                cliente_cpf: document.getElementById('cliente_cpf').value,
                cliente_rg: document.getElementById('cliente_rg').value,
                cliente_endereco: document.getElementById('cliente_endereco').value,
                cliente_telefone: document.getElementById('cliente_telefone').value,
                cliente_telefone_2: document.getElementById('cliente_telefone_2').value,
                aluno_nome_1: document.getElementById('aluno_nome_1').value,
                aluno_nome_2: document.getElementById('qtd_filhos').value === '2' ? document.getElementById('aluno_nome_2').value : "",
                escola_nome: document.getElementById('escola_nome').value,
                escola_horario: document.getElementById('escola_horario').value,
                status: 'pendente', // IMPORTANTE PARA O SEU SISTEMA VER
                data_pedido: new Date().toISOString()
            };

            if(!dados.cliente_nome || !dados.cliente_telefone) {
                alert("Preencha pelo menos Nome e Telefone.");
                btn.disabled = false;
                btn.innerText = "笨 ENVIAR SOLICITAﾃﾃグ";
                return;
            }

            try {
                // SALVA NA COLEﾃﾃグ 'solicitacoes'
                await addDoc(collection(db, "solicitacoes"), dados);
                
                document.getElementById('formPais').reset();
                btn.style.display = 'none';
                document.getElementById('msgSucesso').style.display = 'block';
            } catch (e) {
                alert("Erro ao enviar: " + e.message);
                btn.disabled = false;
                btn.innerText = "Tentar Novamente";
            }
        };
    </script>
</body>
</html>